(function(a){a.fn.spinner=function(t){return this.each(function(){function e(a){c.val(u()+a),n(c)}function n(a){clearTimeout(o.data("timeout"));var t=i(a);l(t)||c.trigger("update",[a,t])}function i(a){var t=u();if(t<=d.min?f.attr("disabled","disabled"):f.removeAttr("disabled"),a.toggleClass("invalid",l(t)).toggleClass("passive",0===t),l(t)){var e=setTimeout(function(){c.val(o.data("lastValidValue")),i(a)},500);o.data("timeout",e)}else o.data("lastValidValue",t);return t}function l(a){return isNaN(+a)||a<d.min}function u(a){return a=a||c,parseInt(a.val()||0,10)}var s={value:0,min:0},d=a.extend(s,t),r={up:38,down:40},o=a("<div></div>");o.addClass("spinner");var c=a(this).addClass("value").attr("maxlength","2").val(d.value).bind("keyup paste change",function(t){var i=a(this);t.keyCode==r.up?e(1):t.keyCode==r.down?e(-1):u(i)!=o.data("lastValidValue")&&n(i)});c.wrap(o);var v=a('<button class="increase">+</button>').click(function(){e(1)}),f=a('<button class="decrease">-</button>').click(function(){e(-1)});i(c),o.data("lastValidValue",d.value),c.before(f),c.after(v)})}})(jQuery);