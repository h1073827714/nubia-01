(function(){var t=function(){document.getElementById("car");var t=new XMLHttpRequest;t.open("POST","./php/ajiax01.php"),t.setRequestHeader("content-type","application/x-www-form-urlencoded"),t.send("commodity=water&price=123&num=2"),t.onload=function(){var n="",r=JSON.parse(t.responseText);if(null!=r[0]){for(let t=0;t<r.length;t++)n+=`<tr>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<div id="car_pic" >\n\t\t\t\t\t\t\t\t<img  src="${r[t].src}">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<p><a href="">${r[t].name}</a></p>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td class="danjia">${r[t].price}</td>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<div id="car_btn">\n\t\t\t\t\t\t\t\t<span id="btn_cut" class="btn_cut">\n\t\t\t\t\t\t\t\t\t-\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span id="btn_num">\n\t\t\t\t\t\t\t\t\t${r[t].num}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span id="btn_add" class="btn_add">\n\t\t\t\t\t\t\t\t\t+\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<a title="删除" class="cart_close ">×</a>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>`;$("#car_tbody").html(n),e()}else $("#car").css("display","none"),$("#empty").css("display","block")}};t();var e=function(){var t=function(){var t=0,e=0,n=document.querySelectorAll(".danjia");for(let r=0;r<n.length;r++){let p=0,a=+n[r].innerText.substr(1),i=+$(n[r]).next().children().children("#btn_num").text();t+=i,p=a*i,p=p.toFixed(2),e+=+p,$(n[r]).next().next().html("¥"+p)}return $(".zhongji").text("¥"+e),$(".zhongji").css("text-align","left"),$("#c_num span").eq(1).text(t),0==t&&($("#car").css("display","none"),$("#empty").css("display","block")),{car_num:t,car_price:e}};t();$(".btn_cut").click(function(){var e=$(this).next().text();if(e--,e<=0)if(confirm("是否取消购买该商品")){var r=$(this).parent().parent().prev().prev().children().children().text().trim();n(r),console.log(r)}else e=1;else{$(this).next().text(e);var p=$(this).parent().parent().prev().prev().children().children().html().trim(),a=$(this).parent().parent().prev().prev().prev().children().children()[0].src,i=$(this).parent().parent().prev().text().trim(),c=new XMLHttpRequest;c.open("POST","php/cart_send.php"),c.setRequestHeader("content-type","application/x-www-form-urlencoded"),c.send(`name=${p}&price=${i}&num=${e}&src=${a}`),t()}}),$(".btn_add").click(function(){var e=$(this).prev().text();e++,$(this).prev().text(e);var n=$(this).parent().parent().prev().prev().children().children().html().trim(),r=$(this).parent().parent().prev().prev().prev().children().children()[0].src,p=$(this).parent().parent().prev().text().trim(),a=new XMLHttpRequest;a.open("POST","php/cart_send.php"),a.setRequestHeader("content-type","application/x-www-form-urlencoded"),a.send(`name=${n}&price=${p}&num=${e}&src=${r}`),t()}),$(".cart_close").click(function(){if(confirm("您确定不购买该商品")){this.parentNode.parentNode.parentNode.removeChild(this.parentNode.parentNode);var e=$(this).parent().siblings(".danjia").prev().children().children().text().trim();n(e),t()}})},n=function(e){console.log("函数知悉了");var n=new XMLHttpRequest;n.open("POST","php/retr.php"),n.setRequestHeader("content-type","application/x-www-form-urlencoded"),n.send(`name=${e}`),n.onload=function(){console.log(n.response),t()}}})();